--------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\fertility-data\fertility-replication-sept-revision\output\logs\section3_b_regressi
> ons.log
  log type:  text
 opened on:  15 Sep 2021, 01:52:04

. 
. 
. *1. Birth Data: NCHS Microdata
. use $ft_data_dir\nchs\nchs_births_pop_1990_2019, clear

. drop if inlist(stname,"AB","BC","MB","NB","NS","ON","QC","SK","XX")
(0 observations deleted)

. keep stname year numbirth1544

. 
. sort stname year 

. statastates, a(stname)
(0 real changes made)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                             1,530  (_merge==3)
    -----------------------------------------

. gen stfips = state_fips

. order state_fips stname year numbirth1544

. drop _merge

. 
. drop if state_fips==.
(0 observations deleted)

. xtset state_fips year
       panel variable:  state_fips (strongly balanced)
        time variable:  year, 1990 to 2019
                delta:  1 unit

. 
. 
. cap drop _merge

. merge 1:1 stname year using $ft_data_dir\annual_policy\policyvars01_19
(note: variable year was int, now float to accommodate using data's values)
(note: variable stname was str2, now str102 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                           561
        from master                       561  (_merge==1)
        from using                          0  (_merge==2)

    matched                               969  (_merge==3)
    -----------------------------------------

. assert _merge == 3 if year>=2001

. keep if _merge==3
(561 observations deleted)

. drop _merge 

. 
. 
. ******** MERGE ST-YEAR POPULATIONS, overall and by race & education ********
. merge 1:1 stname year using $ft_data_dir\pop\age_race_comp_seer.dta , keepusing(pop1519 pop2034 
> pop3544)

    Result                           # of obs.
    -----------------------------------------
    not matched                           561
        from master                         0  (_merge==1)
        from using                        561  (_merge==2)

    matched                               969  (_merge==3)
    -----------------------------------------

. drop _merge

. gen pop1544 = pop1519 + pop2034 + pop3544

. drop pop1519 pop2034 pop3544

. 
. *cap drop state
. *egen state = max(stfips), by(stname)
. 
. tab year, gen(yrdv)

 Birth Year |
  2014 Year |
   of birth |      Freq.     Percent        Cum.
------------+-----------------------------------
       1990 |         51        3.33        3.33
       1991 |         51        3.33        6.67
       1992 |         51        3.33       10.00
       1993 |         51        3.33       13.33
       1994 |         51        3.33       16.67
       1995 |         51        3.33       20.00
       1996 |         51        3.33       23.33
       1997 |         51        3.33       26.67
       1998 |         51        3.33       30.00
       1999 |         51        3.33       33.33
       2000 |         51        3.33       36.67
       2001 |         51        3.33       40.00
       2002 |         51        3.33       43.33
       2003 |         51        3.33       46.67
       2004 |         51        3.33       50.00
       2005 |         51        3.33       53.33
       2006 |         51        3.33       56.67
       2007 |         51        3.33       60.00
       2008 |         51        3.33       63.33
       2009 |         51        3.33       66.67
       2010 |         51        3.33       70.00
       2011 |         51        3.33       73.33
       2012 |         51        3.33       76.67
       2013 |         51        3.33       80.00
       2014 |         51        3.33       83.33
       2015 |         51        3.33       86.67
       2016 |         51        3.33       90.00
       2017 |         51        3.33       93.33
       2018 |         51        3.33       96.67
       2019 |         51        3.33      100.00
------------+-----------------------------------
      Total |      1,530      100.00

. tab stname, gen(stdv)

               Mother's Residence State |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     AK |         30        1.96        1.96
                                     AL |         30        1.96        3.92
                                     AR |         30        1.96        5.88
                                     AZ |         30        1.96        7.84
                                     CA |         30        1.96        9.80
                                     CO |         30        1.96       11.76
                                     CT |         30        1.96       13.73
                                     DC |         30        1.96       15.69
                                     DE |         30        1.96       17.65
                                     FL |         30        1.96       19.61
                                     GA |         30        1.96       21.57
                                     HI |         30        1.96       23.53
                                     IA |         30        1.96       25.49
                                     ID |         30        1.96       27.45
                                     IL |         30        1.96       29.41
                                     IN |         30        1.96       31.37
                                     KS |         30        1.96       33.33
                                     KY |         30        1.96       35.29
                                     LA |         30        1.96       37.25
                                     MA |         30        1.96       39.22
                                     MD |         30        1.96       41.18
                                     ME |         30        1.96       43.14
                                     MI |         30        1.96       45.10
                                     MN |         30        1.96       47.06
                                     MO |         30        1.96       49.02
                                     MS |         30        1.96       50.98
                                     MT |         30        1.96       52.94
                                     NC |         30        1.96       54.90
                                     ND |         30        1.96       56.86
                                     NE |         30        1.96       58.82
                                     NH |         30        1.96       60.78
                                     NJ |         30        1.96       62.75
                                     NM |         30        1.96       64.71
                                     NV |         30        1.96       66.67
                                     NY |         30        1.96       68.63
                                     OH |         30        1.96       70.59
                                     OK |         30        1.96       72.55
                                     OR |         30        1.96       74.51
                                     PA |         30        1.96       76.47
                                     RI |         30        1.96       78.43
                                     SC |         30        1.96       80.39
                                     SD |         30        1.96       82.35
                                     TN |         30        1.96       84.31
                                     TX |         30        1.96       86.27
                                     UT |         30        1.96       88.24
                                     VA |         30        1.96       90.20
                                     VT |         30        1.96       92.16
                                     WA |         30        1.96       94.12
                                     WI |         30        1.96       96.08
                                     WV |         30        1.96       98.04
                                     WY |         30        1.96      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,530      100.00

. 
. format stname %2s

. 
. gen trend = year - 1979

. gen trendsq = trend^2

. gen trendqb = trend^3

.          
. gen trend00 = year - 2000

. gen trend00sq = trend^2

. gen trend00qb = trend^3

. 
. *****ADD STATE SPECIFIC QUADRATIC TRENDS******;
. local stnum 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
>  33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51

. 
. foreach num in `stnum' {
  2.      gen sttrend`num' = trend*stdv`num'
  3.          }

.          
. foreach num in `stnum' {
  2.      gen sttrendsq`num' = trendsq*stdv`num'
  3.          }

.  
. foreach num in `stnum' {
  2.      gen sttrendqb`num' = trendqb*stdv`num'
  3.          }

. 
. foreach num in `stnum' {
  2.      gen sttrend00`num' = trend00*stdv`num'
  3.          }

. 
. foreach num in `stnum' {
  2.      gen sttrendsq00`num' = trend00sq*stdv`num'
  3.          }

.  
. foreach num in `stnum' {
  2.      gen sttrendqb00`num' = trend00qb*stdv`num'
  3.          }

. 
. *clear;
. *gen waivpov19 = waivnoteens2
. *gen pctpop1819_old = pctpop18_old + pctpop19_old
. 
. 
. *** LEVEL BIRTH RATE
. gen brate1544_thsnds = numbirth1544/pop1544*1000
(561 missing values generated)

. *** LOG BIRTH RATE
. gen brate1544 = ln(numbirth1544/pop1544)
(561 missing values generated)

. 
. **** REGRESSIONS
. sort state_fips year

.         
. *PREFERRED SPECIFICATION
. *LEVELS: All + BY AGE, 2001-2019
. local rhsvars unemp logben3 contmand ///
>  parental delay pctmarried pctwhitenh pcthisp pcthsdrop pcthsgrad pctsomecol ///
>  sexed sexedcont sexed1mis sexed2mis tadexpmil logrstateminwage aca_mcaid_exp

. 
.          eststo reg1544_levels: qui areg brate1544_thsnds `rhsvars' yrdv* sttrend00* sttrendsq00
> * ///
>      sttrendqb2-sttrendqb51 if year>=2001 [weight=pop1544], absorb(stname) robust cluster(stname
> )

. 
. local tablevars unemp logben3 contmand ///
>  parental delay sexed sexedcont ///
>  tadexpmil logrstateminwage aca_mcaid_exp  

.  
. local regs reg1544_levels

. 
. esttab `regs', label replace  ///
>         keep(`tablevars') order(`tablevars') b(%9.5f) se(%9.3f) ar2(%9.2f) ///
>         varwidth(25) wrap mtitles("All") ///
>         star(* 0.10 ** 0.05 *** 0.01) title(Level of Birth Rates, Women 15-44, 2001-2019\label{t
> ab2}) 

Level of Birth Rates, Women 15-44, 2001-2019\label{tab2}
-----------------------------------------
                                   (1)   
                                   All   
-----------------------------------------
State Unemployment Rate       -0.46436***
                               (0.088)   

Max Welfare Benefits           2.02965*  
                               (1.026)   

Contraception Coverage        -0.06223   
Mandate                        (0.270)   

Parental Consent for          -0.22444   
Abortion                       (1.699)   

Mandatory wait period for     -0.04624   
Abortion                       (0.803)   

Mandated Sex Educ              0.11318   
                               (0.427)   

Mandated Contraception         0.18615   
Educ                           (0.391)   

tadexpmil                      0.00074   
                               (0.003)   

Log State Min. Wage           -2.43145** 
                               (1.164)   

ACA Medicaid Expansion        -0.59302   
                               (0.415)   
-----------------------------------------
Observations                       969   
Adjusted R-squared                0.99   
-----------------------------------------
Standard errors in parentheses
* p<0.10, ** p<0.05, *** p<0.01

. 
.         
.         
. *******************************************
. ******* FOR BETAS*(Change in X) ***********
. *******************************************
. 
. *sum x-variables in 2007 & 2019
. local sumvars unemp logben3 contmand parental delay ///
> sexed sexedcont tadexpmil logrstateminwage aca_mcaid_exp

. 
. sum `sumvars' if year==2007

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
       unemp |        51    4.327451    .9968106        2.7        7.1
     logben3 |        51    6.005162    .3775504   5.169911   6.861742
    contmand |        51    .4901961    .5048782          0          1
    parental |        51    .7058824     .460179          0          1
       delay |        51    .4509804    .5025426          0          1
-------------+--------------------------------------------------------
       sexed |        51    .5490196    .5025426          0          1
   sexedcont |        51    .3137255    .4686233          0          1
   tadexpmil |        51    108.6702    168.2697   8.101199   1136.343
logrstatem~e |        51    1.827511    .1930232   1.008672   2.104766
aca_mcaid_~p |        51           0           0          0          0

. sum `sumvars' if year==2019

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
       unemp |        51    3.621569    .8217819        2.4        6.1
     logben3 |        51    5.908346    .4163914   4.960444   6.796314
    contmand |        51    .5882353    .4970501          0          1
    parental |        51     .745098    .4401426          0          1
       delay |        51    .4901961    .5048782          0          1
-------------+--------------------------------------------------------
       sexed |        51     .627451    .4882944          0          1
   sexedcont |        51    .3594118    .4800184          0          1
   tadexpmil |        51    117.0741    157.0304   9.766955   1003.008
logrstatem~e |        51    2.000465    .2311142   1.463642   2.463703
aca_mcaid_~p |        51    .6666667    .4760952          0          1

.  
. keep if year == 2007 | year==2019
(1428 observations deleted)

. collapse (mean) meanunemp=unemp meanlogben3=logben3 meancontmand=contmand ///
>  meanparental=parental  meandelay=delay meansexed=sexed ///
>  meansexedcont=sexedcont meantadexpmil=tadexpmil meanlogrstateminwage=logrstateminwage ///
>  meanaca_mcaid_exp=aca_mcaid_exp, by(year)

.  
. 
. reshape long mean, i(year) j(var) string
(note: j = aca_mcaid_exp contmand delay logben3 logrstateminwage parental sexed sexedcont tadexpmi
> l unemp)
meansexedcont:  2 values would be changed; not changed

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                        2   ->      20
Number of variables                  11   ->       3
j variable (10 values)                    ->   var
xij variables:
meanaca_mcaid_exp meancontmand ... meanunemp-> mean
-----------------------------------------------------------------------------

. reshape wide mean, i(var) j(year)
(note: j = 2007 2019)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       20   ->      10
Number of variables                   3   ->       3
j variable (2 values)              year   ->   (dropped)
xij variables:
                                   mean   ->   mean2007 mean2019
-----------------------------------------------------------------------------

. 
. gen diff_07_19 = mean2019 - mean2007

. gen coeff = .
(10 missing values generated)

. foreach coeff in unemp logben3 contmand parental delay ///
> sexed sexedcont tadexpmil logrstateminwage aca_mcaid_exp {
  2. replace coeff = _b[`coeff'] if var == "`coeff'"
  3. }
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. 
. gen predicted_ch = diff_07_19*coeff

. 
. ***** USING 2007 & 2019 BIRTH RATES FROM CDC (in Fig 1)
. ***** 2007 = 69.1
. ***** 2019 = 58.3
. gen pct_of_decline = predicted_ch/(58.3-69.1)*100

. 
. 
. *For Sec 3.B: What Percent of Total Decline is Explained by these Factors?
. egen total_pct_decline_explained = total(pct_of_decline)

. qui sum total_pct_decline

. di r(mean)
6.2753444

.  
. cap log close
